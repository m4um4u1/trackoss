<div [class]="layout.rootClasses()">
  <!-- Toggle Button -->
  <button
    (click)="toggleSidepanel()"
    [attr.aria-expanded]="layout.isSidepanelOpen()"
    [attr.aria-label]="layout.isSidepanelOpen() ? 'Close sidepanel' : 'Open sidepanel'"
    [class]="layout.toggleButtonClasses()"
    class="btn btn-light shadow-sm d-flex align-items-center justify-content-center"
    title="Toggle sidepanel"
  >
    <i class="bi bi-layout-split"></i>
  </button>

  <!-- Backdrop for mobile only -->
  @if (responsive.isMobile() && layout.isSidepanelOpen()) {
    <div (click)="onBackdropClick()" class="backdrop"></div>
  }

  <div class="container-fluid h-100 p-0">
    <div class="row g-0 h-100 d-flex">
      <!-- Sidepanel -->
      <div appMobileTouchScroll [class]="layout.sidepanelClasses()" class="sidepanel-container">
        <app-sidepanel [waypoints]="currentWaypoints" (waypointsChanged)="onWaypointsChanged($event)" />
      </div>

      <!-- Map Container -->
      <div [class]="layout.mapClasses()" class="map-container">
        <app-libre-map
          (waypointsChanged)="onWaypointsChanged($event)"
          (startPointChanged)="onStartPointChanged($event)"
          (endPointChanged)="onEndPointChanged($event)"
          [endPoint]="currentEndPoint"
          [startPoint]="currentStartPoint"
          [waypoints]="currentWaypoints"
        />
      </div>
    </div>
  </div>
</div>
